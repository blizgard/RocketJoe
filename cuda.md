#Driver and Cuda Toolkit 

## ubuntu 19.04

### Remove

    sudo rm /etc/apt/sources.list.d/cuda*
    sudo apt remove --autoremove nvidia-cuda-toolkit
    sudo apt remove --autoremove nvidia-*
    sudo apt remove --purge nvidia* && sudo apt autoremove
    sudo rm -r /var/lib/dkms/nvidia
    sudo apt install --reinstall dkms
    sudo apt purge 'nvidia.*'
    
### Check 
    dkms status    
    
    nvidia, 430.40, 5.0.0-23-generic, x86_64: installed

### Install Driver
    
    sudo add-apt-repository ppa:graphics-drivers/ppa
    sudo apt install build-essential
    sudo apt install nvidia-driver-430
    sudo shutdown -r Now
    prime-select intel
 
Create a file at /etc/modprobe.d/blacklist-nouveau.conf with the following contents:

    blacklist nouveau
    options nouveau modeset=0
    
vim /lib/modprobe.d/blacklist-nvidia.conf 
    
    # Do not modify
    # This file was generated by nvidia-prime
    #blacklist nvidia
    blacklist nvidia-drm
    #blacklist nvidia-modeset
    #alias nvidia off
    alias nvidia-drm off
    #alias nvidia-modeset off
    
vim /lib/modprobe.d/nvidia-graphics-drivers.conf  
    
    blacklist nouveau
    blacklist lbm-nouveau
    alias nouveau off
    alias lbm-nouveau off
  

### Check 
    nvidia-smi    
    
    +-----------------------------------------------------------------------------+
    | NVIDIA-SMI 430.40       Driver Version: 430.40       CUDA Version: 10.1     |
    |-------------------------------+----------------------+----------------------+
    | GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
    | Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
    |===============================+======================+======================|
    |   0  Quadro M2200        Off  | 00000000:01:00.0 Off |                  N/A |
    | N/A   44C    P8    N/A /  N/A |      0MiB /  4043MiB |      0%      Default |
    +-------------------------------+----------------------+----------------------+
                                                                                   
    +-----------------------------------------------------------------------------+
    | Processes:                                                       GPU Memory |
    |  GPU       PID   Type   Process name                             Usage      |
    |=============================================================================|
    |  No running processes found                                                 |
    +-----------------------------------------------------------------------------+

## Install Cuda toolkit

    sudo apt-key adv --fetch-keys  http://developer.download.nvidia.com/compute/cuda/repos/ubuntu1810/x86_64/7fa2af80.pub
    sudo bash -c 'echo "deb http://developer.download.nvidia.com/compute/cuda/repos/ubuntu1810/x86_64 /" > /etc/apt/sources.list.d/cuda.list'
    sudo apt update
    sudo apt install cuda-10-1    
    
    
###url help 
 
     https://askubuntu.com/questions/1122512/nvidia-modules-are-missing-after-each-kernel-upgrade-in-18-04
     https://wiki.ubuntu.com/UEFI/SecureBoot/DKMS   